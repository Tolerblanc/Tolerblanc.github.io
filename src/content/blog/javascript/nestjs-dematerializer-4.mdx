---
title: NestJS í•´ì²´ë¶„ì„ê¸° 4 - ì˜ˆì™¸ì²˜ë¦¬ í•„í„°(Exception Filter)ì™€ íŒŒì´í”„(Pipe)
excerpt: NestJSê°€ ì˜ˆì™¸ ì²˜ë¦¬ì™€ ì…ë ¥ê°’ ê²€ì¦ì„ ìš°ì•„í•˜ê²Œ ë‹¤ë£¨ëŠ” ë°©ë²•
date: 2025-02-23T00:00:00.000Z
categories:
  - JavaScript
tags:
  - NodeJS
  - NestJS
  - Exception
  - Filter
  - Pipe
toc: true
tocDepth: 3
draft: false
lang: ko
author: Tolerblanc
updatedDate: 2025-02-23T00:00:00.000Z
description: NestJSê°€ ì˜ˆì™¸ ì²˜ë¦¬ì™€ ì…ë ¥ê°’ ê²€ì¦ì„ ìš°ì•„í•˜ê²Œ ë‹¤ë£¨ëŠ” ë°©ë²•
series:
  name: NestJS í•´ì²´ë¶„ì„ê¸°
  order: 4
---

<Notice type="info">
ğŸ‘¨â€ğŸ’» ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ ì…ë‹ˆë‹¤. 

ğŸ’¡ í‹€ë¦° ë‚´ìš©ì´ë‚˜ ì˜¤íƒ€ëŠ” ëŒ“ê¸€, ë©”ì¼ë¡œ ì œë³´í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!!  (__)
</Notice>

## Introduction

ì§€ë‚œ 3í¸ì—ì„œëŠ” NestJSì˜ ì‹¤í–‰ íë¦„ì„ ì œì–´í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´, ê°€ë“œ, ì¸í„°ì…‰í„°ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤. 

<LinkCard 
  href="https://tolerblanc.github.io/javascript/nestjs-dematerializer-3/" 
  title="NestJS í•´ì²´ë¶„ì„ê¸° 3 - ë¯¸ë“¤ì›¨ì–´, ê°€ë“œ, ì¸í„°ì…‰í„°" 
  description="NestJSì˜ ìš”ì²­ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ê³¼ AOP êµ¬í˜„ í•µì‹¬ ìš”ì†Œë“¤ ì´í•´í•˜ê¸°" 
/>

ì´ë²ˆì—ëŠ” NestJSì—ì„œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê³  ì…ë ¥ê°’ì„ ê²€ì¦í•˜ëŠ” ë‘ ê°€ì§€ í•µì‹¬ ê¸°ëŠ¥ì¸ **ì˜ˆì™¸ í•„í„°(Exception Filter)** ì™€ **íŒŒì´í”„(Pipe)** ë¥¼ ì‚´í´ë³´ë ¤ê³  í•œë‹¤. 

## ì˜ˆì™¸ í•„í„°(Exception Filter)ì˜ ë™ì‘ ì›ë¦¬

NestJSì˜ ì˜ˆì™¸ í•„í„°ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë“  ì˜ˆì™¸ë¥¼ ì¡ì•„ë‚´ëŠ” ìºì¹˜ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤. ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸(`ExecutionContext`)ë¥¼ í†µí•´ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ìš”ì²­/ì‘ë‹µ ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì¼ê´€ëœ í˜•ì‹ì˜ ì—ëŸ¬ ì‘ë‹µì„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

ìš°ì„ , ì‹¤í–‰ ìˆœì„œë¶€í„° ì•Œì•„ë³´ì:

<Steps>
#### ì˜ˆì™¸ ë°œìƒ
ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì–´ëŠ ì§€ì ì—ì„œë“  ì˜ˆì™¸ê°€ throwë¨

#### ì˜ˆì™¸ ë ˆì´ì–´ ê°ì§€
NestJSì˜ ì˜ˆì™¸ ë ˆì´ì–´ê°€ ì˜ˆì™¸ë¥¼ ê°ì§€

#### í•„í„° ê²€ìƒ‰
í•´ë‹¹ ì˜ˆì™¸ íƒ€ì…ì— ë§ì¶° ë“±ë¡ëœ í•„í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ 

#### catch() ë©”ì„œë“œ ì‹¤í–‰
í•„í„°ì˜ `catch()` ë©”ì„œë“œ ì‹¤í–‰

#### ì‘ë‹µ ì „ì†¡
í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ìµœì¢… ì—ëŸ¬ ì‘ë‹µ ì „ì†¡
</Steps>

ë§Œì•½ íŠ¹ì • ì˜ˆì™¸ í•„í„°ê°€ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, NestJSëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” ê¸°ë³¸ ì˜ˆì™¸ í•„í„°(`BaseExceptionFilter`)ë¥¼ ì‚¬ìš©í•œë‹¤.

ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ëŠ” HTTP ê³„ì¸µì—ì„œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸(HttpException)ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ë‹¤. ì•„ë˜ ì˜ˆì‹œëŠ” ê¸°ë³¸ì ì¸ ë¡œê¹… ê¸°ëŠ¥ê³¼ í•¨ê»˜, ì˜ˆì™¸ ì •ë³´ë¥¼ ì¼ê´€ëœ JSON í˜•íƒœë¡œ ë°˜í™˜í•œë‹¤:

```typescript
// http-exception.filter.ts
@Catch(HttpException)
export class HttpExceptionFilter implements ExceptionFilter {
  constructor(private readonly logger: Logger) {}

  catch(exception: HttpException, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse<Response>();
    const request = ctx.getRequest<Request>();
    const status = exception.getStatus();
    const errorResponse = exception.getResponse();

    // ì—ëŸ¬ ë¡œê¹…
    this.logger.error(
      `${request.method} ${request.url} - ${status}`,
      exception.stack
    );

    // ì‘ë‹µ ì „ì†¡
    response.status(status).json({
      statusCode: status,
      timestamp: new Date().toISOString(),
      path: request.url,
      error: {
        code: errorResponse['code'] || 'UNKNOWN_ERROR',
        message: errorResponse['message'] || 'An unexpected error occurred',
        details: process.env.NODE_ENV === 'development' ? exception.stack : undefined
      }
    });
  }
}
```

ì—¬ê¸°ì„œ í™•ì¸í•  ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- ë¡œê¹…: ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡œê¹…ì„ ë‚¨ê¹€ìœ¼ë¡œì¨ ì„œë²„ ìš´ì˜ ì¤‘ ë°œìƒí•œ ë¬¸ì œë¥¼ ë¹ ë¥´ê²Œ íŒŒì•… ê°€ëŠ¥
- ì‘ë‹µ êµ¬ì¡°: `statusCode`, `timestamp`, `path`, `error` ë“± í´ë¼ì´ì–¸íŠ¸ê°€ ì—ëŸ¬ ìƒí™©ì„ ì •í™•íˆ ì¸ì§€í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ì •ë³´ë¥¼ êµ¬ì¡°í™”
- ê°œë°œ í™˜ê²½ ë¶„ê¸° ì²˜ë¦¬: `NODE_ENV`ì— ë”°ë¼ ì˜ˆì™¸ì˜ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤(stack trace)ë¥¼ í¬í•¨í• ì§€ ê²°ì •

í•˜ì§€ë§Œ, ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” `HttpException`ë§Œìœ¼ë¡œ ì—ëŸ¬ ìƒí™©ì„ ëª¨ë‘ ì²˜ë¦¬í•˜ê¸° ì–´ë µë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì ì •ë³´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ `UserNotFoundException`ê³¼ ê°™ì€ êµ¬ì²´ì ì¸ ì˜ˆì™¸ë¥¼ ë§Œë“¤ì–´ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ë„ë©”ì¸(ì—…ë¬´ ë¡œì§)ë§ˆë‹¤ ì˜ˆì™¸ë¥¼ ë¶„ë¦¬í•˜ë©´ ìœ ì§€ë³´ìˆ˜ì™€ ë””ë²„ê¹…ì´ í›¨ì”¬ ìˆ˜ì›”í•´ì§„ë‹¤. ì•„ë˜ ì˜ˆì‹œë¥¼ ë³´ì:

```typescript
// business.exception.ts
export class BusinessException extends HttpException {
  constructor(
    private readonly code: string,
    message: string,
    private readonly details?: Record<string, any>,
    status: number = 400
  ) {
    super(
      {
        code,
        message,
        details,
        status
      },
      status
    );
  }

  getCode(): string {
    return this.code;
  }

  getDetails(): Record<string, any> | undefined {
    return this.details;
  }
}

// user.exceptions.ts
export class UserNotFoundException extends BusinessException {
  constructor(userId: string | number) {
    super(
      'USER_NOT_FOUND',
      `User with id ${userId} not found`,
      { userId },
      404
    );
  }
}

export class DuplicateEmailException extends BusinessException {
  constructor(email: string) {
    super(
      'DUPLICATE_EMAIL',
      'Email already exists',
      { email },
      409
    );
  }
}
```

ì´ëŸ¬í•œ ê³„ì¸µí™”ëœ ì˜ˆì™¸ êµ¬ì¡°ë¥¼ êµ¬ì¶•í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì´ ìˆë‹¤.

- ìœ ì§€ë³´ìˆ˜ì„±: ì˜ˆì™¸ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•´ë‘ë©´, ë‚˜ì¤‘ì— ë¹„ìŠ·í•œ ì—ëŸ¬ ìƒí™©ì´ ë°œìƒí–ˆì„ ë•Œ ì¬í™œìš©í•˜ê±°ë‚˜ í™•ì¥í•˜ê¸° ì‰¬ì›€
- ê°€ë…ì„±: `throw new UserNotFoundException(123)` ê°™ì€ í˜•íƒœë¡œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´, ì½”ë“œë§Œ ë´ë„ ì˜ˆì™¸ì˜ ì˜ë¯¸ë¥¼ ì§ê´€ì ìœ¼ë¡œ íŒŒì•…í•  ìˆ˜ ìˆìŒ
- ì½”ë“œ ì¬ì‚¬ìš©: ê³µí†µ ì—ëŸ¬ í¬ë§·(`BusinessException`)ì„ í™•ì¥í•˜ì—¬ ë„ë©”ì¸ ì „ë°˜ì— ê±¸ì³ ì¼ê´€ëœ ì˜ˆì™¸ ì²˜ë¦¬ ê°€ëŠ¥

ì˜ˆì™¸ í•„í„°ë¥¼ ì „ì—­ì ìœ¼ë¡œ ì ìš©í•˜ì§€ ì•Šê³ , íŠ¹ì • ì»¨íŠ¸ë¡¤ëŸ¬ë‚˜ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ë‹¨ìœ„ë¡œë„ ì ìš©í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì´ `@UseFilters()` ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤:

```typescript
@Controller('users')
@UseFilters(HttpExceptionFilter)
export class UserController {
  // ...
}
```

ê·¸ ì™¸, ê¸€ë¡œë²Œ ë ˆë²¨ì—ì„œ ì ìš©í•  ìˆ˜ë„ ìˆë‹¤:

```typescript
//main.ts
async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  // ...
  app.useGlobalFilters(new HttpExceptionFilter(new Logger()));
  // ...
  await app.listen(3000);
}
```

## íŒŒì´í”„(Pipe)ì˜ ë™ì‘ ì›ë¦¬ì™€ í™œìš©

íŒŒì´í”„ëŠ” PipeëŠ” NestJSì—ì„œ ìš”ì²­ ê°ì²´ë¥¼ ê°€ê³µí•˜ê±°ë‚˜(ë³€í™˜) ìœ íš¨ì„± ê²€ì¦ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ê¸°ëŠ¥ì´ë‹¤. `@Body()`, `@Param()`, `@Query()` ë“±ì˜ ë°ì½”ë ˆì´í„°ë¡œ ì¶”ì¶œëœ íŒŒë¼ë¯¸í„°ì— ëŒ€í•´ `transform()` ë©”ì„œë“œë¥¼ í†µí•´ ì „ì²˜ë¦¬ ê³¼ì •ì„ ê±°ì¹œ ë’¤, ì»¨íŠ¸ë¡¤ëŸ¬ë‚˜ ì„œë¹„ìŠ¤ë¡œ ì „ë‹¬ëœë‹¤. ì•„ë˜ì™€ ê°™ì€ ë™ì‘ íë¦„ì„ ê°€ì§„ë‹¤:

<Steps>
#### ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ìš”ì²­ ì§„ì…
í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° íŠ¹ì • ë¼ìš°íŠ¸ë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜´

#### íŒŒì´í”„ ì‹¤í–‰
NestJSëŠ” íŒŒì´í”„ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ë©°, `transform(inputValue, metadata)` ë©”ì„œë“œë¥¼ í†µí•´ ê°’ ê²€ì¦ ë˜ëŠ” ë³€í™˜ ë¡œì§ì„ ìˆ˜í–‰

#### ê²°ê³¼ ì „ë‹¬
íŒŒì´í”„ê°€ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•Šìœ¼ë©´ ë³€í™˜ëœ(í˜¹ì€ ê·¸ëŒ€ë¡œì¸) ê°’ì„ í•¸ë“¤ëŸ¬ì— ì „ë‹¬
</Steps>

NestJSì—ì„œëŠ” `class-transformer`ì™€ `class-validator`ë¥¼ ì‚¬ìš©í•˜ëŠ” `ValidationPipe`ë¥¼ í™œìš©í•´ DTO ë‹¨ì—ì„œ í¸ë¦¬í•˜ê²Œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

```typescript
// validation.pipe.ts
@Injectable()
export class ValidationPipe implements PipeTransform<any> {
  constructor(private readonly options: ValidationPipeOptions = {}) {}

  async transform(value: any, metadata: ArgumentMetadata) {
    // ê°’ì´ ì—†ìœ¼ë©´ ì—ëŸ¬ ì²˜ë¦¬
    if (!value) {
      if (this.options.skipMissingProperties) {
        return value;
      }
      throw new BadRequestException('No data submitted');
    }

    // plainToClassë¥¼ ì´ìš©í•´ DTO ì¸ìŠ¤í„´ìŠ¤ë¡œ ë³€í™˜
    const object = plainToClass(metadata.metatype, value);

    // ìœ íš¨ì„± ê²€ì‚¬ ìˆ˜í–‰
    const errors = await validate(object, {
      whitelist: true,
      forbidNonWhitelisted: true,
      ...this.options
    });

    // ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ì²˜ë¦¬
    if (errors.length > 0) {
      throw new BadRequestException({
        code: 'VALIDATION_FAILED',
        message: 'Validation failed',
        details: this.formatErrors(errors)
      });
    }

    return value;
  }

  private formatErrors(errors: ValidationError[]): Record<string, string[]> {
    return errors.reduce((acc, err) => {
      acc[err.property] = Object.values(err.constraints);
      return acc;
    }, {});
  }
}
```

- `whitelist: true` ì˜µì…˜ì€ DTOì— ì •ì˜ë˜ì§€ ì•Šì€ ì†ì„±ì€ ìë™ìœ¼ë¡œ ì œê±°í•œë‹¤.
- `forbidNonWhitelisted: true` ì˜µì…˜ì€ DTOì— ì •ì˜ë˜ì§€ ì•Šì€ ì†ì„±ì´ í¬í•¨ëœ ê²½ìš° ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.
- `skipMissingProperties`ì™€ ê°™ì€ ì˜µì…˜ì„ ì‚¬ìš©í•´ í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆì„ ë•Œì˜ ì²˜ë¦¬ ë°©ì‹ ë“±ì„ ìœ ì—°í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆë‹¤.

ì‹¤ì œ DTOì—ì„œ ê° í•„ë“œë§ˆë‹¤ ë‹¤ì–‘í•œ ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„ ì–¸ì ìœ¼ë¡œ ê²€ì¦í•˜ëŠ” ì˜ˆì‹œë„ ì‚´í´ë³´ì:

```typescript
// user.dto.ts
export class CreateUserDto {
  @IsString()
  @MinLength(2, { message: 'Name must be at least 2 characters long' })
  @MaxLength(50, { message: 'Name cannot exceed 50 characters' })
  name: string;

  @IsEmail({}, { message: 'Please provide a valid email address' })
  @Transform(({ value }) => value.toLowerCase()) // ì´ë©”ì¼ì„ í•­ìƒ ì†Œë¬¸ìë¡œ ë³€í™˜
  email: string;

  @IsString()
  @MinLength(8, { message: 'Password must be at least 8 characters long' })
  @Matches(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/, {
    message: 'Password must contain at least 1 uppercase letter, 1 lowercase letter, and 1 number or special character'
  })
  password: string;

  @IsOptional()
  @IsString()
  @MaxLength(500, { message: 'Bio cannot exceed 500 characters' })
  bio?: string;
}
```

- `@IsEmail` ë°ì½”ë ˆì´í„°ë¥¼ ì´ìš©í•´ ì´ë©”ì¼ í˜•ì‹ì„ ìë™ ê²€ì‚¬
- `@Transform` ë°ì½”ë ˆì´í„°ë¥¼ í†µí•´ ê°’ ë³€í™˜(ì—¬ê¸°ì„œëŠ” ì´ë©”ì¼ì„ í•­ìƒ ì†Œë¬¸ìë¡œ)
- `@IsOptional()`ì„ ì‚¬ìš©í•´ í•´ë‹¹ í•„ë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šì•„ë„ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì„¤ì •

ìœ„ì—ì„œ êµ¬í˜„í•œ ValidationPipeì™€ DTOë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í˜•íƒœê°€ ëœë‹¤:

```typescript
// user.controller.ts
@Controller('users')
export class UserController {
  constructor(private readonly userService: UserService) {}

  @Post()
  @UseFilters(new HttpExceptionFilter())
  async createUser(@Body(new ValidationPipe()) createUserDto: CreateUserDto) {
    try {
      return await this.userService.create(createUserDto);
    } catch (error) {
      // ì˜ˆ: DBì— ê°™ì€ ì´ë©”ì¼ì´ ì¡´ì¬í•  ê²½ìš° ì—ëŸ¬ í•¸ë“¤ë§
      if (error instanceof QueryFailedError && error.message.includes('duplicate key')) {
        throw new DuplicateEmailException(createUserDto.email);
      }
      throw error;
    }
  }

  @Get(':id')
  @UseFilters(new HttpExceptionFilter())
  async getUser(@Param('id', ParseIntPipe) id: number) {
    const user = await this.userService.findById(id);
    if (!user) {
      throw new UserNotFoundException(id);
    }
    return user;
  }
}
```

- `@Param('id', ParseIntPipe)`ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì •ìˆ˜ë¡œ ë³€í™˜. ë³€í™˜ì´ ì‹¤íŒ¨í•˜ë©´ NestJSì˜ ë‚´ì¥ ì˜ˆì™¸(BadRequestException)ê°€ ë°œìƒ
- `@Body(new ValidationPipe())`ë¡œ ìš”ì²­ ë°”ë””ë¥¼ DTOì— ë§ì¶° ê²€ì‚¬. ìœ íš¨ì„± ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ì˜ˆì™¸ ë°œìƒ
- ë°œìƒí•œ ì˜ˆì™¸(`DuplicateEmailException`, `UserNotFoundException`)ëŠ” `HttpExceptionFilter`ì—ì„œ ì¼ê´€ëœ í¬ë§·ìœ¼ë¡œ ì²˜ë¦¬

íŒŒì´í”„ ë˜í•œ ì „ì—­ì ìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ì´ ê²½ìš°ì—ëŠ” ëª¨ë“  ìš”ì²­ì—ì„œ ìë™ìœ¼ë¡œ ìœ íš¨ì„± ê²€ì‚¬ê°€ ì´ë¤„ì§€ë¯€ë¡œ, ì‚¬ìš©ì„ ì§€ì–‘í•˜ëŠ”ê²Œ ì¢‹ë‹¤ê³  ìƒê°í•œë‹¤. ìƒê°ì¹˜ ëª»í•œ ì‚¬ì´ë“œ ì´í™íŠ¸ê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë¬¼ë¡  ì „ì—­ íŒŒì´í”„ê°€ ë“±ë¡ë˜ì–´ ìˆë”ë¼ë„, íŠ¹ì • ë¼ìš°íŠ¸ì— ë³„ë„ë¡œ íŒŒì´í”„ë¥¼ ì ìš©í•˜ì—¬ ì„¸ë°€í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•˜ë‹¤.

```typescript
// main.ts
async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  // ...
  // ê¸€ë¡œë²Œ íŒŒì´í”„ ë“±ë¡
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      forbidNonWhitelisted: true,
    }),
  );
  //...
  // ê¸€ë¡œë²Œ ì˜ˆì™¸ í•„í„° ë“±ë¡
  app.useGlobalFilters(new HttpExceptionFilter(new Logger()));
  //...
  await app.listen(3000);
}
```

## ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ?

1.	ë„ë©”ì¸ ê¸°ë°˜ ì˜ˆì™¸ ê³„ì¸µí™”
    - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì˜ˆì™¸ë¥¼ ì²´ê³„ì ìœ¼ë¡œ êµ¬ë¶„í•´ `BusinessException` ë“±ìœ¼ë¡œ ì¶”ìƒí™”í•´ë‘ë©´, í™•ì¥ê³¼ ìœ ì§€ë³´ìˆ˜ê°€ ìš©ì´í•˜ë‹¤.
2.	ê¸€ë¡œë²Œ vs ë¡œì»¬(ë©”ì„œë“œ/ì»¨íŠ¸ë¡¤ëŸ¬) ì ìš© ì „ëµ
    - ëª¨ë“  ë¡œì§ì— ê³µí†µ ì ìš©ì´ í•„ìš”í•œ ë¶€ë¶„(ë¡œê·¸ í¬ë§·, ê¸°ë³¸ ìœ íš¨ì„± ê²€ì‚¬ ë“±)ì€ ê¸€ë¡œë²Œì„ í™œìš©í•˜ê³ , ë„ë©”ì¸/ìš”ê±´ ë³„ë¡œ ì„¸ë°€í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ í•„ìš”í•œ ë¶€ë¶„ì€ ì»¨íŠ¸ë¡¤ëŸ¬ ìˆ˜ì¤€ì—ì„œ `@UseFilters()`, `@UsePipes()`ë¥¼ ì‚¬ìš©í•œë‹¤.
3.	`ValidationPipe` ì˜µì…˜
    - `whitelist`, `forbidNonWhitelisted`, `transform` ë“±ì„ ì ì ˆíˆ ì„¤ì •í•´ ë³´ì•ˆì„±ê³¼ ê°œë°œ í¸ì˜ì„±ì„ ë†’ì¸ë‹¤.
    - skipMissingProperties ê°™ì€ ì˜µì…˜ì„ í™œìš©í•´ PATCH ë©”ì„œë“œë‚˜ ë¶€ë¶„ ì—…ë°ì´íŠ¸ ì‹œì—ë„ DTO ìœ íš¨ì„± ê²€ì¦ì„ ìœ ì—°í•˜ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.
4.	ì—ëŸ¬ ì½”ë“œ ë° ë©”ì‹œì§€ í‘œì¤€í™”
    - ì—ëŸ¬ ì‘ë‹µ êµ¬ì¡°ë¥¼ ì¼ê´€ë˜ê²Œ ì„¤ê³„í•˜ë©´, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ë•Œ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  ë””ë²„ê¹…ì´ ì‰¬ì›Œì§„ë‹¤.
    - ì˜ˆ: `{"code": "USER_NOT_FOUND", "message": "User with id 123 not found", "details": { "userId": "123" }}` ë“±
5.	ë¡œê¹…ê³¼ ëª¨ë‹ˆí„°ë§
    - ì˜ˆì™¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ë¡œê¹…ì„ ë‚¨ê¸°ëŠ” ê²ƒì€ í•„ìˆ˜ë‹¤.
    - ìš´ì˜ ì¤‘ì—ëŠ” ëª¨ë‹ˆí„°ë§ íˆ´ê³¼ ì—°ë™í•˜ì—¬ ì˜ˆì™¸ ë°œìƒ ë¹ˆë„ë¥¼ ì¶”ì í•˜ê³ , ì—ëŸ¬ì˜ ì‹¬ê°ë„ë¥¼ ë¶„ë¥˜í•´ ë¹ ë¥´ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.


## ê²°ë¡  ë° ìš”ì•½, ë‹¤ìŒí¸ ì˜ˆê³ 

3ì¤„ë¡œ ìš”ì•½í•˜ìë©´,

- Exception FilterëŠ” NestJS ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë“  ì˜ˆì™¸ë¥¼ ì¡ì•„ë‚´ê³  ì¼ê´€ëœ ì²˜ë¦¬ ë°©ì‹ì„ ì œê³µí•œë‹¤.
- PipeëŠ” ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦í•˜ê³  í•„ìš”í•˜ë‹¤ë©´ ë³€í™˜ê¹Œì§€ ìˆ˜í–‰í•˜ì—¬, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê¸°ëŒ€í•˜ëŠ” í˜•ì‹ê³¼ ë²”ìœ„ë¥¼ ë³´ì¥í•œë‹¤.
- ì˜ˆì™¸ì™€ ê²€ì¦ ë¡œì§ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ í•µì‹¬ ë¡œì§ê³¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ ì½”ë“œì˜ ê°€ë…ì„±, ìœ ì§€ë³´ìˆ˜ì„±, ì•ˆì •ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.

ë‹¤ìŒ í¸ì—ì„œëŠ” ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°ì™€ `reflect-metadata`ì— ëŒ€í•´ ë‹¤ë£° ê²ƒì´ë‹¤.
